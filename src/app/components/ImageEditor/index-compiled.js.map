{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["'use strict';\r\n\r\nimport React, {PropTypes, Component} from 'react';\r\nimport './ImageEditor.css';\r\nimport classNames from 'classnames';\r\n\r\nclass ImageEditor extends Component {\r\n  constructor(...args) {\r\n    super(...args);\r\n    this.canvas = null;\r\n    this.image = new Image();\r\n    this.selectedRectangle = {x: 0, y: 0, w: 0, h: 0};\r\n    this.beingEdited = false;\r\n    this.setCanvas = this.setCanvas.bind(this);\r\n    this.drawImage = this.drawImage.bind(this);\r\n    this.handleMouseMove = this.handleMouseMove.bind(this);\r\n    this.handleMouseDown = this.handleMouseDown.bind(this);\r\n    this.handleMouseUp = this.handleMouseUp.bind(this);\r\n  }\r\n\r\n  render() {\r\n    const {className, style} = this.props;\r\n    const {setCanvas} = this;\r\n    return (\r\n      <div style={style} className={classNames('ImageEditor', className)}>\r\n        <canvas\r\n          id=\"canvas\"\r\n          ref={setCanvas} style={{cursor: 'crosshair'}}\r\n          onMouseMove={this.handleMouseMove} onMouseDown={this.handleMouseDown}\r\n          onMouseUp={this.handleMouseUp}\r\n          >\r\n        </canvas>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  handleMouseDown(e) {\r\n    const mousePos = this.getMousePos(e);\r\n    this.startRectangleSelection(mousePos);\r\n    this.beingEdited = true;\r\n  }\r\n\r\n  startRectangleSelection(mousePos) {\r\n    const {selectedRectangle: selRect} = this;\r\n    selRect.x = mousePos.x;\r\n    selRect.y = mousePos.y;\r\n    selRect.w = 0;\r\n    selRect.h = 0;\r\n  }\r\n\r\n  handleMouseMove(e) {\r\n    if (!this.beingEdited) {\r\n      return;\r\n    }\r\n    const mousePos = this.getMousePos(e);\r\n    this.updateSelectedRectangle(mousePos);\r\n    this.redrawImage();\r\n  }\r\n\r\n  updateSelectedRectangle(mousePos) {\r\n    const {selectedRectangle: selRect} = this;\r\n    selRect.w = mousePos.x - selRect.x;\r\n    selRect.h = mousePos.y - selRect.y;\r\n  }\r\n\r\n  getMousePos(e) {\r\n    const {canvas} = this;\r\n    const canvasRect = canvas.getBoundingClientRect();\r\n    const mousePos = {\r\n      x: Math.round((e.clientX - canvasRect.left) / (canvasRect.right - canvasRect.left) * canvas.width),\r\n      y: Math.round((e.clientY - canvasRect.top) / (canvasRect.bottom - canvasRect.top) * canvas.height)\r\n    };\r\n    return mousePos;\r\n  }\r\n\r\n  handleMouseUp() {\r\n    this.beingEdited = false;\r\n    this.finishRectangleSelection();\r\n    this.props.onRectangleSelected({...this.selectedRectangle});\r\n    this.redrawImage();\r\n  }\r\n\r\n  finishRectangleSelection() {\r\n    const {selectedRectangle: selRect} = this;\r\n    if (selRect.w < 0) {\r\n      selRect.x += selRect.w;\r\n      selRect.w *= -1;\r\n    }\r\n    if (selRect.h < 0) {\r\n      selRect.y += selRect.h;\r\n      selRect.h *= -1;\r\n    }\r\n  }\r\n\r\n  redrawImage() {\r\n    const {canvas, image, selectedRectangle: selRect} = this;\r\n    const ctx = canvas.getContext('2d');\r\n    ctx.drawImage(image, 0, 0);\r\n    ctx.strokeStyle = 'green';\r\n    ctx.lineWidth = '2';\r\n    ctx.strokeRect(selRect.x, selRect.y, selRect.w, selRect.h);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.drawImage();\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    this.drawImage();\r\n  }\r\n\r\n  setCanvas(canvas) {\r\n    this.canvas = canvas;\r\n  }\r\n\r\n  drawImage() {\r\n    const {canvas, image} = this;\r\n    const ctx = canvas.getContext('2d');\r\n    image.onload = () => {\r\n      canvas.width = image.width;\r\n      canvas.height = image.height;\r\n      ctx.drawImage(image, 0, 0);\r\n    };\r\n    image.src = this.props.imageDataUrl;\r\n  }\r\n\r\n  drawRectangle() {\r\n    const {canvas} = this;\r\n    const ctx = canvas.getContext('2d');\r\n    ctx.rect(0, 0, 200, 100);\r\n    ctx.fillStyle = 'yellow';\r\n    ctx.fill();\r\n    ctx.lineWidth = 7;\r\n    ctx.strokeStyle = 'black';\r\n    ctx.stroke();\r\n  }\r\n}\r\n\r\nImageEditor.propTypes = {\r\n  imageDataUrl: PropTypes.string.isRequired,\r\n  className: PropTypes.string,\r\n  style: PropTypes.object,\r\n  onRectangleSelected: PropTypes.func\r\n};\r\n\r\nImageEditor.defaultProps = {\r\n  className: null,\r\n  style: null,\r\n  onRectangleSelected: () => {}\r\n};\r\n\r\nexport default ImageEditor;\r\n"]}